<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" contentScriptType="application/ecmascript" contentStyleType="text/css"
     height="393px" preserveAspectRatio="none" style="width:651px;height:393px;" version="1.1" viewBox="0 0 651 393"
     width="651px" zoomAndPan="magnify"><defs><filter height="300%" id="f66gwd29vt07e" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster Unprocessed--><rect fill="#FEFECE" filter="url(#f66gwd29vt07e)" height="129" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="617" x="22" y="75"/><rect fill="#FFFFFF" height="96.7031" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="611" x="25" y="104.2969"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="22" x2="639" y1="101.2969" y2="101.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="288.5" y="91.9951">Unprocessed</text><!--cluster Processed--><rect fill="#FEFECE" filter="url(#f66gwd29vt07e)" height="129" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="529" x="41" y="253"/><rect fill="#FFFFFF" height="96.7031" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="523" x="44" y="282.2969"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="41" x2="570" y1="279.2969" y2="279.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="272.5" y="269.9951">Processed</text><rect fill="#FEFECE" filter="url(#f66gwd29vt07e)" height="78.2031" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="207" x="38.5" y="110"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="38.5" x2="245.5" y1="136.2969" y2="136.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="114.5" y="127.9951">Awaiting</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="57" x="43.5" y="152.4355">processed</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="40" x="190.5" y="152.4355">= false</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="29" x="43.5" y="166.4043">stuck</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="40" x="190.5" y="166.4043">= false</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="118" x="43.5" y="180.373">delivered_timestamp</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="33" x="190.5" y="180.373">= null</text><rect fill="#FEFECE" filter="url(#f66gwd29vt07e)" height="78.2031" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="207" x="415.5" y="110"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="415.5" x2="622.5" y1="136.2969" y2="136.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="501" y="127.9951">Stuck</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="57" x="420.5" y="152.4355">processed</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="40" x="567.5" y="152.4355">= false</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="29" x="420.5" y="166.4043">stuck</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="567.5" y="166.4043">= true</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="118" x="420.5" y="180.373">delivered_timestamp</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="33" x="567.5" y="180.373">= null</text><rect fill="#FEFECE" filter="url(#f66gwd29vt07e)" height="78.2031" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="207" x="346.5" y="288"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="346.5" x2="553.5" y1="314.2969" y2="314.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="411.5" y="305.9951">Undelivered</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="57" x="351.5" y="330.4355">processed</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="498.5" y="330.4355">= true</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="29" x="351.5" y="344.4043">stuck</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="40" x="498.5" y="344.4043">= false</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="118" x="351.5" y="358.373">delivered_timestamp</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="33" x="498.5" y="358.373">= null</text><rect fill="#FEFECE" filter="url(#f66gwd29vt07e)" height="78.2031" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="254" x="57" y="288"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="57" x2="311" y1="314.2969" y2="314.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="153.5" y="305.9951">Delivered</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="57" x="62" y="330.4355">processed</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="209" y="330.4355">= true</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="29" x="62" y="344.4043">stuck</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="40" x="209" y="344.4043">= false</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="118" x="62" y="358.373">delivered_timestamp</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="209" y="358.373">= [TIMESTAMP]</text><ellipse cx="142" cy="18" fill="#000000" filter="url(#f66gwd29vt07e)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><!--link *start to Awaiting--><path d="M142,28.277 C142,44.104 142,77.269 142,104.688 " fill="none" id="*start-Awaiting" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="142,109.735,146,100.735,142,104.735,138,100.735,142,109.735" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Awaiting to Stuck--><path d="M245.537,167.058 C252.11,167.825 258.639,168.486 265,169 C323.033,173.687 337.967,173.687 396,169 C400.672,168.623 405.434,168.166 410.237,167.646 " fill="none" id="Awaiting-Stuck" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="415.463,167.058,406.0725,164.0885,410.4943,167.6166,406.9662,172.0384,415.463,167.058" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="266" y="165.0669">Неудачная доставка</text><!--link Awaiting to Stuck--><path d="M250.817,149 C302.623,149 364.27,149 415.388,149 " fill="none" id="Awaiting-Stuck-1" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="245.516,149,254.516,153,250.516,149,254.516,145,245.516,149" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="264" y="142.0669">Перезапуск очереди</text><!--link Awaiting to Delivered--><path d="M151.113,188.189 C157.773,216.096 166.81,253.968 173.726,282.948 " fill="none" id="Awaiting-Delivered" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="174.904,287.885,176.7038,278.202,173.7425,283.0218,168.9227,280.0604,174.904,287.885" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="163" y="233.0669">Удачная доставка</text><!--link Stuck to Undelivered--><path d="M504.028,188.189 C493.087,216.096 478.24,253.968 466.878,282.948 " fill="none" id="Stuck-Undelivered" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="464.943,287.885,471.9533,280.9672,466.7689,283.2303,464.5058,278.0459,464.943,287.885" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="491" y="233.0669">Отправка на повтор</text><!--
@startuml

state Unprocessed {

    Awaiting: processed\t\t\t\t = false
    Awaiting: stuck\t\t\t\t\t = false
    Awaiting: delivered_timestamp\t\t = null

    Stuck: processed\t\t\t\t = false
    Stuck: stuck\t\t\t\t\t = true
    Stuck: delivered_timestamp\t\t = null

}

state Processed {

    Undelivered: processed\t\t\t\t = true
    Undelivered: stuck\t\t\t\t\t = false
    Undelivered: delivered_timestamp\t\t = null

    Delivered: processed\t\t\t\t = true
    Delivered: stuck\t\t\t\t\t = false
    Delivered: delivered_timestamp\t\t = [TIMESTAMP]

}

[*] - -> Awaiting

Awaiting -> Stuck: Неудачная доставка
Awaiting -> Delivered : Удачная доставка

Stuck -left-> Awaiting : Перезапуск очереди
Stuck - -> Undelivered : Отправка на повтор

@enduml

PlantUML version 1.2019.08(Sat Jul 13 22:25:14 MSK 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.3+12-b304.39
Operating System: Linux
OS Version: 4.9.0-8-amd64
Default Encoding: UTF-8
Language: ru
Country: RU
--></g></svg>